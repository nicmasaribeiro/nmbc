<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <title>Calculate f(t), g(t, r), S(t, r) and Simulation</title>
    <script>
        // Normal PDF (Gaussian distribution) approximation function
        function normPdf(x, mean, variance) {
            const scale = Math.sqrt(variance);
            const expTerm = Math.exp(-0.5 * Math.pow((x - mean) / scale, 2));
            return expTerm / (scale * Math.sqrt(2 * Math.PI));
        }

        // Define B(s) as the PDF of a normal distribution with mean 0 and variance 1/s
        function B(s) {
            if (s === 0) return 0; // Avoid division by zero
            return normPdf(s, 0, 1 / Math.max(s, 0.01)); // Safeguard small s values
        }

        // Function to approximate the integral from 0 to s of a function f
        function integrate(f, s, step = 0.01) {
            let result = 0;
            for (let t = 0; t <= s; t += step) {
                result += f(t) * step; // Riemann sum approximation
            }
            return result;
        }

        // Function to compute f(s)
        function f(s) {
            // First term: s^2 * B(s)^2
            const first_term = Math.pow(s, 2) * Math.pow(B(s), 2);

            // Second term: -2s * B(s) * integral of B(t) from 0 to s
            const second_term = -2 * s * B(s) * integrate(B, s);

            // Third term: integral from 0 to s of (integral from 0 to s of B(x)^2 dx) dy
            const inner_integral = (x) => Math.pow(B(x), 2);
            const outer_integral = (y) => integrate(inner_integral, s); // Inner integral with respect to x
            const third_term = integrate(outer_integral, s);

            // Calculate final f(s)
            return first_term + second_term + third_term;
        }

        // Function to compute g(t, r) = (1 - r^2) * e^(r * f(t))
        function g(t, r) {
            const ft = f(t);
            return (1 - Math.pow(r, 2)) * Math.exp(r * ft);
        }

        // Function to compute S(t, r)
        // S(t, r) = g(t, r)^t * d_t + exp(f(t)) * B(t)
        function S(t, r, dt) {
            const gt = g(t, r);
            const ft = f(t);
            const bt = B(t);
            return Math.pow(gt, t) * dt + Math.exp(ft) * bt;
        }

        // Softmax function
        function softmax(values) {
            const expValues = values.map(v => Math.exp(v));
            const sumExp = expValues.reduce((a, b) => a + b, 0);
            return expValues.map(v => v / sumExp);
        }

        // Function to calculate and display f(t), g(t, r), and S(t, r), including softmax
        function calculate() {
            const t = parseFloat(document.getElementById("t").value);
            const r = parseFloat(document.getElementById("r").value);
            const dt = parseFloat(document.getElementById("dt").value);

            // Calculate f(t), g(t, r), and S(t, r)
            const ft = f(t);
            const gt = g(t, r);
            const st = S(t, r, dt);

            // Calculate softmax of f(t), g(t, r), and S(t, r)
            const softmaxValues = softmax([ft, gt, st]);

            // Display the results
            document.getElementById("result_f").innerText = `f(${t}) = ${ft.toFixed(6)}`;
            document.getElementById("result_g").innerText = `g(${t}, ${r}) = ${gt.toFixed(6)}`;
            document.getElementById("result_s").innerText = `S(${t}, ${r}) = ${st.toFixed(6)}`;
            document.getElementById("result_softmax").innerText = `Softmax: [f(t) = ${softmaxValues[0].toFixed(6)}, g(t, r) = ${softmaxValues[1].toFixed(6)}, S(t, r) = ${softmaxValues[2].toFixed(6)}]`;
        }

        // Function to simulate values over a range of t and r
        function simulate() {
            const start_t = parseFloat(document.getElementById("start_t").value);
            const end_t = parseFloat(document.getElementById("end_t").value);
            const r_value = parseFloat(document.getElementById("r_sim").value);
            const dt = parseFloat(document.getElementById("dt_sim").value);
            const step = parseFloat(document.getElementById("step_t").value);

            let output = "<table border='1'><tr><th>t</th><th>f(t)</th><th>g(t, r)</th><th>S(t, r)</th></tr>";

            for (let t = start_t; t <= end_t; t += step) {
                const ft = f(t);
                const gt = g(t, r_value);
                const st = S(t, r_value, dt);

                output += `<tr><td>${t.toFixed(2)}</td><td>${ft.toFixed(6)}</td><td>${gt.toFixed(6)}</td><td>${st.toFixed(6)}</td></tr>`;
            }

            output += "</table>";
            document.getElementById("simulationResult").innerHTML = output;
        }
    </script>
</head>
<body>
    <h4><a href="/stoch/tools">Back</a></h4>
    <h1>Calculate f(t), g(t, r), S(t, r) and Simulation</h1>
    <!-- Explanation Section -->
    <h2>Explanation of the Equations and Their Implications</h2>
    <p><strong>f(t)</strong>: This function represents a complex relationship involving stochastic noise as it accumulates over time. It incorporates the impact of a Gaussian distribution on the system's state over time. The first term captures the local magnitude of the noise, while the second and third terms account for the interaction between the system's history and cumulative effects of noise. This equation is commonly used in models of random processes where noise has a significant effect.</p>
    
    <p><strong>g(t, r)</strong>: The function \( g(t, r) = (1 - r^2) e^{r f(t)} \) represents the growth or decay of a system under stochastic influences. Here, \( r \) modulates the influence of noise (with \( r = 0 \) representing no stochastic effects), and \( f(t) \) amplifies or reduces the impact of this noise over time. When \( r \) is positive, the system tends toward growth, while negative \( r \) values represent decay.</p>
    
    <p><strong>S(t, r)</strong>: \( S(t, r) \) combines the effects of \( g(t, r) \) and the random distribution \( B(t) \) to capture the overall state of a stochastic system. It models how randomness and growth factors interact over time. The first term, \( g(t, r)^t \cdot dt \), models growth modulated by time, while the second term captures the direct effect of noise on the system's evolution.</p>
    
    <p><strong>Softmax</strong>: The softmax function is used to normalize the values of \( f(t) \), \( g(t, r) \), and \( S(t, r) \), transforming them into probabilities. This normalization is useful for comparing the relative contributions of different factors to the system. The higher the softmax value of a particular function, the greater its influence on the overall behavior of the system. It allows us to assess the most significant factor in a complex stochastic process.</p>

    <h2>Calculate f(t), g(t, r), and S(t, r)</h2>

    <label for="t">Enter value for t: </label>
    <input type="number" id="t" step="0.01" value="1"><br><br>

    <label for="r">Enter value for r: </label>
    <input type="number" id="r" step="0.01" value="0.5"><br><br>

    <label for="dt">Enter value for dt: </label>
    <input type="number" id="dt" step="0.01" value="1"><br><br>

    <button onclick="calculate()">Calculate f(t), g(t, r), and S(t, r)</button>

    <h3 id="result_f">f(t) = </h3>
    <h3 id="result_g">g(t, r) = </h3>
    <h3 id="result_s">S(t, r) = </h3>
    <h3 id="result_softmax">Softmax: </h3>

    <h2>Simulation of f(t), g(t, r), and S(t, r)</h2>

    <label for="start_t">Start value for t: </label>
    <input type="number" id="start_t" step="0.1" value="0"><br><br>

    <label for="end_t">End value for t: </label>
    <input type="number" id="end_t" step="0.1" value="5"><br><br>

    <label for="r_sim">Enter value for r (for simulation): </label>
    <input type="number" id="r_sim" step="0.01" value="0.5"><br><br>

    <label for="dt_sim">Enter value for dt (for simulation): </label>
    <input type="number" id="dt_sim" step="0.01" value="1"><br><br>

    <label for="step_t">Step size for t: </label>
    <input type="number" id="step_t" step="0.01" value="0.1"><br><br>

    <button onclick="simulate()">Run Simulation</button>

    <h3>Simulation Results:</h3>
    <div id="simulationResult"></div>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1, h2, h3 {
            margin-bottom: 10px;
        }

        table {
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 5px 10px;
            text-align: center;
        }
    </style>
</body>
</html>